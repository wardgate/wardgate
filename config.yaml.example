server:
  listen: ":8080"
  base_url: "http://localhost:8080"  # Base URL for links in notifications
  admin_key_env: WARDGATE_ADMIN_KEY  # Env var for admin key (enables Web UI at /ui/)
  logging:
    max_entries: 1000      # Max log entries to keep in memory for dashboard (default: 1000)
    store_bodies: false    # Store request bodies in logs (default: false, for privacy)

# =============================================================================
# SENSITIVE DATA FILTERING (global defaults)
# =============================================================================
# Filtering is enabled by default to prevent agents from seeing OTP codes,
# verification links, and API keys. Configure per-endpoint to override.

filter_defaults:
  enabled: true
  patterns:
    - otp_codes           # OTP/verification codes (e.g., "Code: 123456")
    - verification_links  # Email verification/password reset URLs
    - api_keys            # Common API key formats (sk-..., ghp_..., etc.)
  action: block           # block | redact | ask | log
  replacement: "[SENSITIVE DATA REDACTED]"

agents:
  - id: agent-name
    key_env: WARDGATE_AGENT_KEY

# Notification settings for "ask" workflow
notify:
  timeout: "5m"  # How long to wait for approval
  # slack:
  #   webhook_url: "https://hooks.slack.com/services/YOUR/WEBHOOK/URL"
  # webhook:
  #   url: "https://your-webhook.example.com/notify"
  #   headers:
  #     Authorization: "Bearer your-token"

# =============================================================================
# PRESETS DIRECTORY
# =============================================================================
# Presets are loaded from YAML files. The presets/ directory contains
# pre-configured presets for popular APIs. See docs/presets.md for details.

# Load presets from the presets directory (required for using presets)
presets_dir: ./presets

# =============================================================================
# CUSTOM PRESETS (optional)
# =============================================================================
# Define your own presets inline, or add YAML files to presets_dir.

# Or define inline custom presets
# custom_presets:
#   my-internal-api:
#     description: "My Company Internal API"
#     upstream: https://api.internal.company.com/v1
#     auth_type: bearer
#     capabilities:
#       - name: read_data
#         description: "Read resources"
#         rules:
#           - match: { method: GET }
#       - name: create_resources
#         description: "Create new resources"
#         rules:
#           - match: { method: POST, path: "/resources" }
#       - name: delete_resources
#         description: "Delete resources"
#         rules:
#           - match: { method: DELETE }

# =============================================================================
# ENDPOINTS
# =============================================================================

endpoints:
  # ---------------------------------------------------------------------------
  # USING PRESETS (recommended)
  # ---------------------------------------------------------------------------
  # See docs/presets.md for all presets, capabilities and examples.

  todoist:
    preset: todoist
    description: "Todoist API (Personal)"  # Optional: shown in discovery API for agents
    auth:
      credential_env: WARDGATE_CRED_TODOIST_API_KEY
    capabilities:
      read_data: allow
      create_tasks: allow
      close_tasks: allow
      update_tasks: ask
      delete_tasks: deny

  # ---------------------------------------------------------------------------
  # MANUAL CONFIGURATION (for custom APIs or advanced use)
  # ---------------------------------------------------------------------------
  # See docs/config.md for full configuration reference.

  # custom-api:
  #   upstream: https://api.example.com/v1
  #   auth:
  #     type: bearer
  #     credential_env: WARDGATE_CRED_CUSTOM_API
  #   rules:
  #     - match: { method: GET }
  #       action: allow
  #     - match: { method: POST, path: "/allowed-endpoint" }
  #       action: allow
  #     - match: { method: "*" }
  #       action: deny

  # ---------------------------------------------------------------------------
  # IMAP (email reading) - using preset
  # ---------------------------------------------------------------------------

  # mail-read:
  #   preset: imap
  #   upstream: imaps://imap.gmail.com:993  # Override with your server
  #   auth:
  #     credential_env: WARDGATE_CRED_IMAP  # format: user@gmail.com:app-password
  #   capabilities:
  #     list_folders: allow
  #     read_inbox: allow
  #     mark_read: ask
  #   # Filter sensitive data (OTPs, verification links) - enabled by default
  #   # filter:
  #   #   enabled: true
  #   #   action: block

  # ---------------------------------------------------------------------------
  # IMAP for OTP inbox (filtering disabled to allow agent to read codes)
  # ---------------------------------------------------------------------------

  # mail-otp:
  #   preset: imap
  #   upstream: imaps://imap.gmail.com:993
  #   auth:
  #     credential_env: WARDGATE_CRED_IMAP_OTP
  #   capabilities:
  #     list_folders: allow
  #     read_inbox: allow
  #   filter:
  #     enabled: false  # Allow OTP codes for automated account creation

  # ---------------------------------------------------------------------------
  # SMTP (email sending) - using preset
  # ---------------------------------------------------------------------------

  # mail-send:
  #   preset: smtp
  #   upstream: smtps://smtp.gmail.com:465  # Override with your server
  #   auth:
  #     credential_env: WARDGATE_CRED_SMTP  # format: user@gmail.com:app-password
  #   capabilities:
  #     send_email: ask
  #   # Optional: additional SMTP controls (see docs/config.md)
  #   # smtp:
  #   #   from: "your-email@gmail.com"
  #   #   known_recipients:
  #   #     - "@company.com"
  #   #   ask_new_recipients: true
